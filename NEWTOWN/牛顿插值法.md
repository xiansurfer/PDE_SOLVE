# 牛顿插值法

## 观测点

$$
x_{samples} = [x_{0},x_{1},x_{2}....x_{n}]
$$


$$
y_{samples} = [y_{0},y_{1},y_{2}....y_{n}]
$$

## 差商

### 一阶差商

$$
f[x_0,x_1] = \frac{f(x_1)-f(x_0)}{x_1-x_0}
$$

$$
f[x_1,x_2] = \frac{f(x_2)-f(x_1)}{x_2-x_1}
$$

### 二阶差商

$$
f[x_0,x_1,x_2]=\frac{f[x_1,x_2]-f[x_0,x_1]}{x_2-x_0}
$$

###  三阶差商

$$
f[x_0,x_1,x_2,x_3]=\frac{f[x_1,x_2,x_3]-f[x_0,x_1,x_2]}{x_3-x_0}
$$

#### n阶差商

$$
f[x_0,x_1,x_2...x_n]=\frac{f[x_1,x_2,...x_n]-f[x_0,x_1,...x_{n-1}]}{x_n-x_0}
$$

## 差商表

| x    | f(x) | 一阶差商 | 二阶差商 | 三阶差商 | ........... | n阶差商 |
| :--: | :--: | :------: | :------: | :------: | :--: | :-----: |
| x0 | f(x0) |          |          |          |      |         |
| x1 | f(x1) | f[x0,x1] |          |          |      |         |
| x2 | f(x2) | f[x1,x2] | f[x0,x1,x2] |          |      |         |
| x3 | f(x3) | f[x2,x3] | f[x1,x2,x3] | f[x0,x1,x2,x3] |      |         |
|...| ...| ... | ... | ... | ........... |         |
| xn | f(xn) | f[xn-1,xn] | f[xn-2,xn-1,xn] | f[xn-3,xn-2,xn-1,xn] | ........... | f[x0,x1....xn] |



## 牛顿插值公式

$$
N(X)=f(x_0)+f[x_0,x_1](x-x_0)+f[x_0,x_1,x_2](x-x_0)(x-x_1)+....f[x_0,x_1,...x_n](x-x_0)..(x-x_{n-1})
$$

## 算例

样本点如下：
$$
x_{samples}=[-2,-1,1,2]
$$

$$
y_{samples}=[5,3,17,21]
$$

差商表如下：

|  x   | f(x) | 一阶差商 | 二阶差商 | 三阶差商 |
| :--: | :--: | :------: | :------: | :------: |
|  -2  |  5   |          |          |          |
|  -1  |  3   |    -2    |          |          |
|  1   |  17  |    7     |    3     |          |
|  2   |  21  |    4     |    -1    |    -1    |



插值公式如下:
$$
N(x)=5-2(x+2)+3(x+2)(x+1)-(x+2)(x+1)(x-1)
$$
